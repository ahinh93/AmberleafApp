<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Testing Variable Read/Write</title>
    <script>
        function saveData() {
            var fname = document.getElementById('first-name').value;
            var lname = document.getElementById('last-name').value;
            //alert("First name: " + fname + "\nLast Name: " + lname);
            // alert("yes");
            writeUserData(fname, lname);
        }
        function writeUserData(fname, lname) {

            //var firebase = require('firebase');
            //create reference to database service
            alert(typeof admin);
            var database = firebase.database().ref("projectData/server");
            alert("yes2");

            var usersRef = database.child("server");

            alert("yes3");
            usersRef.set({
                alanisawesome: {
                    date_of_birth: "June 23, 1912",
                    full_name: "Alan Turing"
                },
                gracehop: {
                    date_of_birth: "December 9, 1906",
                    full_name: "Grace Hopper"
                }
            });
            alert("yes4");


            // alert("done");
        }
        function retrieveDatabase() {
            var admin = require("firebase-admin");
            alert(typeof admin);
            //var x = document.getElementById('dataText').value;
            //document.getElementById("dataText").innerHTML = "hello, world";
            var db = admin.database();
            alert("yes11");
            var ref = db.ref("projectData/server");
            alert("yes22");
            ref.on("value",function(snapshot){
                document.getElementById("dataText").innerHTML = "yes";
            }, function (errorObject) {
                document.getElementById("dataText").innerHTML = "error";
            });
        }
        
        function clearTextBox() {
            document.getElementById("dataText").innerHTML = "";
        }
    </script>
</head>

<body>
    <!--Import desired Firebase Javascript SDK's-->
    <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase.js"></script>
    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyD47NOjIbQYeNZtwbIEqTNfRZSDmAp1E14",
            authDomain: "amberleaf-app.firebaseapp.com",
            databaseURL: "https://amberleaf-app.firebaseio.com",
            projectId: "amberleaf-app",
            storageBucket: "amberleaf-app.appspot.com",
            messagingSenderId: "522203017902",
            appId: "1:522203017902:web:1b9fab7ae49d0670d0b33f",
            measurementId: "G-HYLXXYF545"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>

    <form id="myForm" onsubmit="saveData()">
        <h2>First Name</h2>
        <input type="text" id="first-name" name="fname" required><br>
        <h2>Last Name</h2>
        <input type="text" id="last-name" name="lname" required><br>
        <button type="submit" value="submit">Submit</button>
    </form>


    <div id="myDatabase">
        <button onclick="retrieveDatabase()">Retrieve Database</button>
        <button onclick="clearTextBox()">Clear Text</button>
        <div id="container">
            <p id="dataText"></p>
        </div>
    </div>
</body>

</html>